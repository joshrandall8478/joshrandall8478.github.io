---
import '../styles/index.css';
import Layout from '../layouts/MainLayout.astro';
export async function getLatestProject() {
    const allPosts = await Astro.glob('./projects/*.md');
    const nonDraftPosts = allPosts.filter((post) => !post.frontmatter.draft)
    nonDraftPosts.sort((a, b) => Date.parse(b.frontmatter.date) - Date.parse(a.frontmatter.date));
    return nonDraftPosts[0];
}
const latestProject = await getLatestProject();
export async function getLatestPost() {
    const allPosts = await Astro.glob('./posts/*.md');
    const nonDraftPosts = allPosts.filter((post) => !post.frontmatter.draft)
    nonDraftPosts.sort((a, b) => Date.parse(b.frontmatter.date) - Date.parse(a.frontmatter.date));
    return nonDraftPosts[0];
}
const latestPost = await getLatestPost();
const currentPath = Astro.url.pathname;
---
<Layout title="Main" currentPath={currentPath}>
    <!-- Mastodon Verification-->
    <link rel="me" href="https://hachyderm.io/@pursuit"></link>
    <link rel="me" href="https://mastodon.world/@pursuit"></link>
    <link rel="me" href="https://allthingstech.social/@josh"></link>
    <!-- Main Content -->
    <main>
        <section>
            <div class="container">
                <div class="content">
                <h1 id="main_title">Joshua Randall</h1>
                <h2 id="main_subtitle">Computer Science Major</h2>
                <ul class="main_links">
                    <li><a href="https://github.com/joshrandall8478" class="fa-brands fa-github"></a></li>
                    <li><a href="https://www.youtube.com/channel/UCzrgSiEhhs4tcPaZobybY4A" class="fa-brands fa-youtube"></a></li>
                    <li><a href="https://www.instagram.com/joshrandall8478/" class="fa-brands fa-instagram"></a></li>
                    <li><a rel="me" href="https://hachyderm.io/@pursuit" class="fa-brands fa-mastodon"></a></li>
                    </li>
                    <!-- <li><a class="fa-brands fa-discord"></a></li> -->
                </ul>
                <a id="main_button" href="/about">About Page Updated</a>
                <!-- <p id="main__paragraph">Site under construction, check back later ;)</p> -->
                <p id="main_paragraph"><i class="fa-solid fa-angle-down"></i> Scroll for more <i class="fa-solid fa-angle-down"></i></p>
            </div>
            </div>
        </section>
        <hr>
        <section class="next_section align_left" >
            <div class="content">
                <h2>Latest Post</h2>
                <h3>{latestPost.frontmatter.title}</h3>
                <h4>Date: {latestPost.frontmatter.date}</h4>
                <h4>Author: {latestPost.frontmatter.author}</h4>
                <p>{latestPost.frontmatter.description}</p>
                <br>
                <a class="button" href={latestPost.url}> Click here to learn more</a>
            </div>
                <img class="section_image" src={latestPost.frontmatter.image.url} alt="Latest Post Image"/>
    </section>
    <hr>
        <section class="next_section align_right">
            <img class="section_image" src={latestProject.frontmatter.image.url} alt="Latest Project Image"/>
                <div class="content">
                    <h2>Latest Project</h2>
                    <h3>{latestProject.frontmatter.title}</h3>
                    <h4>Date: {latestProject.frontmatter.date}</h4>
                    <p>{latestProject.frontmatter.subtitle}</p>
                    <br>
                    <a class="button" href={latestProject.url}> Click here to learn more</a>
                </div>
                    
        </section>
    </main>
    <!-- <script>
const hr = document.querySelectorAll('hr');
// Create the observer, same as before:
const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
    if (entry.isIntersecting) {
        hr.forEach((element) => {
            element.classList.add('active');
        })
        return;
    }
    });
});

observer.observe(document.querySelector('.section_image'));
    </script> -->
</Layout>